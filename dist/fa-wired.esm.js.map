{"version":3,"file":"fa-wired.esm.js","sources":["../src/resources/js/fa-wired.js"],"sourcesContent":["/*!\n * fa-wired - Fathom Analytic Events for Laravel/Livewire\n * https://github.com/kerkness/fa-wired\n */\n\n// Version info (replaced by Vite during build)\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : '1.0.0';\nconst BUILD_DATE = typeof __BUILD_DATE__ !== 'undefined' ? __BUILD_DATE__ : new Date().toISOString();\n\n// Main FaWired object\nconst FaWired = {\n    version: VERSION,\n    buildDate: BUILD_DATE,\n\n    // Initialize the Alpine.js integration\n    init() {\n        if (typeof document === 'undefined') {\n            console.warn('fa-wired: Document not available, skipping initialization');\n            return;\n        }\n\n        // Wait for Alpine to be ready\n        if (typeof Alpine !== 'undefined') {\n            this.initializeAlpine();\n        } else {\n            document.addEventListener('alpine:init', () => {\n                this.initializeAlpine();\n            });\n        }\n\n        // Initialize Livewire integration if available\n        if (typeof Livewire !== 'undefined') {\n            this.initializeLivewire();\n        } else {\n            document.addEventListener('livewire:init', () => {\n                this.initializeLivewire();\n            });\n        }\n\n        // Initialize auto-tracking on DOM ready\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', () => {\n                this.initializeAutoTracking();\n            });\n        } else {\n            this.initializeAutoTracking();\n        }\n    },\n\n    // Initialize Alpine.js components\n    initializeAlpine() {\n        // Global Alpine.js store for Fathom tracking\n        Alpine.store('fathom', {\n            // Track a simple event\n            track(eventName, value = null) {\n                if (typeof fathom === 'undefined') {\n                    console.warn('fa-wired: Fathom Analytics not loaded');\n                    return;\n                }\n\n                const options = value ? { _value: value } : {};\n                fathom.trackEvent(eventName, options);\n            },\n\n            // Track click events\n            click(eventName, value = null) {\n                this.track(eventName, value);\n            },\n\n            // Track form submissions\n            submit(eventName, value = null) {\n                this.track(eventName, value);\n            },\n\n            // Track conversions with value (value in cents)\n            conversion(eventName, value) {\n                this.track(eventName, value);\n            },\n\n            // Track download events\n            download(fileName, eventName = null) {\n                const name = eventName || `file download: ${fileName}`;\n                this.track(name);\n            },\n\n            // Track external link clicks\n            externalLink(url, eventName = null) {\n                const name = eventName || `external link: ${url}`;\n                this.track(name);\n            }\n        });\n\n        // Alpine.js magic helper for quick access\n        Alpine.magic('fathom', () => Alpine.store('fathom'));\n\n        // Alpine.js directive for automatic click tracking\n        Alpine.directive('track-click', (el, { expression }, { evaluate }) => {\n            const config = evaluate(expression);\n            const eventName = typeof config === 'string' ? config : config.event;\n            const value = typeof config === 'object' ? config.value : null;\n\n            el.addEventListener('click', () => {\n                Alpine.store('fathom').click(eventName, value);\n            });\n        });\n\n        // Alpine.js directive for automatic form submission tracking\n        Alpine.directive('track-submit', (el, { expression }, { evaluate }) => {\n            const config = evaluate(expression);\n            const eventName = typeof config === 'string' ? config : config.event;\n            const value = typeof config === 'object' ? config.value : null;\n\n            el.addEventListener('submit', () => {\n                Alpine.store('fathom').submit(eventName, value);\n            });\n        });\n\n        // Alpine.js directive for download tracking\n        Alpine.directive('track-download', (el, { expression }, { evaluate }) => {\n            const config = evaluate(expression);\n            const eventName = typeof config === 'string' ? config : config.event;\n\n            el.addEventListener('click', (e) => {\n                const href = el.getAttribute('href');\n                const fileName = href ? href.split('/').pop() : 'unknown';\n                Alpine.store('fathom').download(fileName, eventName);\n            });\n        });\n\n        // Alpine.js directive for external link tracking\n        Alpine.directive('track-external', (el, { expression }, { evaluate }) => {\n            const config = evaluate(expression);\n            const eventName = typeof config === 'string' ? config : config.event;\n\n            el.addEventListener('click', (e) => {\n                const href = el.getAttribute('href');\n                Alpine.store('fathom').externalLink(href, eventName);\n            });\n        });\n    },\n\n    // Initialize Livewire integration\n    initializeLivewire() {\n        // Track Livewire component interactions\n        Livewire.on('fathom-track', (data) => {\n            Alpine.store('fathom').track(data.event, data.value || null);\n        });\n\n        // Track Livewire form submissions\n        Livewire.on('fathom-form-submit', (data) => {\n            Alpine.store('fathom').submit(data.event, data.value || null);\n        });\n\n        // Track Livewire conversions\n        Livewire.on('fathom-conversion', (data) => {\n            Alpine.store('fathom').conversion(data.event, data.value);\n        });\n    },\n\n    // Initialize automatic tracking features\n    initializeAutoTracking() {\n        // Auto-track external links (optional - can be enabled via config)\n        if (this.config?.autoTrackExternalLinks) {\n            document.querySelectorAll('a[href^=\"http\"]:not([href*=\"' + window.location.hostname + '\"])').forEach(link => {\n                link.addEventListener('click', () => {\n                    Alpine.store('fathom').externalLink(link.href);\n                });\n            });\n        }\n\n        // Auto-track file downloads (optional - can be enabled via config)\n        if (this.config?.autoTrackDownloads) {\n            document.querySelectorAll('a[href$=\".pdf\"], a[href$=\".doc\"], a[href$=\".docx\"], a[href$=\".xls\"], a[href$=\".xlsx\"]').forEach(link => {\n                link.addEventListener('click', () => {\n                    const fileName = link.href.split('/').pop();\n                    Alpine.store('fathom').download(fileName);\n                });\n            });\n        }\n    },\n\n    // Configuration object for optional features\n    config: {\n        autoTrackExternalLinks: false,\n        autoTrackDownloads: false\n    },\n\n    // Method to update configuration\n    configure(options) {\n        this.config = { ...this.config, ...options };\n    }\n};\n\n// Auto-initialize if running in browser\nif (typeof window !== 'undefined') {\n    // Make FaWired globally accessible\n    window.FaWired = FaWired;\n\n    // Auto-initialize\n    FaWired.init();\n\n    // Log version info in development\n    if (process.env.NODE_ENV === 'development') {\n        console.log(`fa-wired v${VERSION} initialized`);\n    }\n}\n\n// Export for module systems\nexport default FaWired;"],"names":[],"mappings":"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"}