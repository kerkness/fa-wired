{"version":3,"file":"fa-wired.esm.js","sources":["../src/resources/js/fa-wired.js"],"sourcesContent":["/*!\n * fa-wired - Fathom Analytics Alpine.js wrapper for Laravel/Livewire\n * https://github.com/kerkness/fa-wired\n */\n\n// Version info (replaced by Vite during build)\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : '1.0.0';\nconst BUILD_DATE = typeof __BUILD_DATE__ !== 'undefined' ? __BUILD_DATE__ : new Date().toISOString();\n\n// Main FaWired object\nconst FaWired = {\n  version: VERSION,\n  buildDate: BUILD_DATE,\n  \n  // Initialize the Alpine.js integration\n  init() {\n    if (typeof document === 'undefined') {\n      console.warn('fa-wired: Document not available, skipping initialization');\n      return;\n    }\n\n    // Wait for Alpine to be ready\n    if (typeof Alpine !== 'undefined') {\n      this.initializeAlpine();\n    } else {\n      document.addEventListener('alpine:init', () => {\n        this.initializeAlpine();\n      });\n    }\n\n    // Initialize Livewire integration if available\n    if (typeof Livewire !== 'undefined') {\n      this.initializeLivewire();\n    } else {\n      document.addEventListener('livewire:init', () => {\n        this.initializeLivewire();\n      });\n    }\n\n    // Initialize auto-tracking on DOM ready\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', () => {\n        this.initializeAutoTracking();\n      });\n    } else {\n      this.initializeAutoTracking();\n    }\n  },\n\n  // Initialize Alpine.js components\n  initializeAlpine() {\n    // Global Alpine.js store for Fathom tracking\n    Alpine.store('fathom', {\n      // Track a simple event\n      track(eventName, value = null) {\n        if (typeof fathom === 'undefined') {\n          console.warn('fa-wired: Fathom Analytics not loaded');\n          return;\n        }\n\n        const options = value ? { _value: value } : {};\n        fathom.trackEvent(eventName, options);\n      },\n\n      // Track click events\n      click(eventName, value = null) {\n        this.track(eventName, value);\n      },\n\n      // Track form submissions\n      submit(eventName, value = null) {\n        this.track(eventName, value);\n      },\n\n      // Track conversions with value (value in cents)\n      conversion(eventName, value) {\n        this.track(eventName, value);\n      },\n\n      // Track download events\n      download(fileName, eventName = null) {\n        const name = eventName || `file download: ${fileName}`;\n        this.track(name);\n      },\n\n      // Track external link clicks\n      externalLink(url, eventName = null) {\n        const name = eventName || `external link: ${url}`;\n        this.track(name);\n      }\n    });\n\n    // Alpine.js magic helper for quick access\n    Alpine.magic('fathom', () => Alpine.store('fathom'));\n\n    // Alpine.js directive for automatic click tracking\n    Alpine.directive('track-click', (el, { expression }, { evaluate }) => {\n      let config;\n      \n      try {\n        // Try to evaluate as a normal Alpine expression first\n        config = evaluate(expression);\n      } catch (error) {\n        // If evaluation fails, treat the raw expression as a string\n        config = expression;\n      }\n      \n      const eventName = typeof config === 'string' ? config : config.event;\n      const value = typeof config === 'object' ? config.value : null;\n\n      el.addEventListener('click', () => {\n        Alpine.store('fathom').click(eventName, value);\n      });\n    });\n\n    // Alpine.js directive for automatic form submission tracking\n    Alpine.directive('track-submit', (el, { expression }, { evaluate }) => {\n      let config;\n      \n      try {\n        config = evaluate(expression);\n      } catch (error) {\n        config = expression;\n      }\n      \n      const eventName = typeof config === 'string' ? config : config.event;\n      const value = typeof config === 'object' ? config.value : null;\n\n      el.addEventListener('submit', () => {\n        Alpine.store('fathom').submit(eventName, value);\n      });\n    });\n\n    // Alpine.js directive for download tracking\n    Alpine.directive('track-download', (el, { expression }, { evaluate }) => {\n      let config;\n      \n      try {\n        config = evaluate(expression);\n      } catch (error) {\n        config = expression;\n      }\n      \n      const eventName = typeof config === 'string' ? config : config.event;\n      \n      el.addEventListener('click', (e) => {\n        const href = el.getAttribute('href');\n        const fileName = href ? href.split('/').pop() : 'unknown';\n        Alpine.store('fathom').download(fileName, eventName);\n      });\n    });\n\n    // Alpine.js directive for external link tracking\n    Alpine.directive('track-external', (el, { expression }, { evaluate }) => {\n      let config;\n      \n      try {\n        config = evaluate(expression);\n      } catch (error) {\n        config = expression;\n      }\n      \n      const eventName = typeof config === 'string' ? config : config.event;\n      \n      el.addEventListener('click', (e) => {\n        const href = el.getAttribute('href');\n        Alpine.store('fathom').externalLink(href, eventName);\n      });\n    });\n  },\n\n  // Initialize Livewire integration\n  initializeLivewire() {\n    // Track Livewire component interactions\n    Livewire.on('fathom-track', (data) => {\n      Alpine.store('fathom').track(data.name, data.value || null);\n    });\n\n    // Track Livewire form submissions\n    Livewire.on('fathom-form-submit', (data) => {\n      Alpine.store('fathom').submit(data.name, data.value || null);\n    });\n\n    // Track Livewire conversions\n    Livewire.on('fathom-conversion', (data) => {\n      Alpine.store('fathom').conversion(data.name, data.value);\n    });\n  },\n\n  // Initialize automatic tracking features\n  initializeAutoTracking() {\n    // Auto-track external links (optional - can be enabled via config)\n    if (this.config?.autoTrackExternalLinks) {\n      document.querySelectorAll('a[href^=\"http\"]:not([href*=\"' + window.location.hostname + '\"])').forEach(link => {\n        link.addEventListener('click', () => {\n          Alpine.store('fathom').externalLink(link.href);\n        });\n      });\n    }\n\n    // Auto-track file downloads (optional - can be enabled via config)\n    if (this.config?.autoTrackDownloads) {\n      document.querySelectorAll('a[href$=\".pdf\"], a[href$=\".doc\"], a[href$=\".docx\"], a[href$=\".xls\"], a[href$=\".xlsx\"]').forEach(link => {\n        link.addEventListener('click', () => {\n          const fileName = link.href.split('/').pop();\n          Alpine.store('fathom').download(fileName);\n        });\n      });\n    }\n  },\n\n  // Configuration object for optional features\n  config: {\n    autoTrackExternalLinks: false,\n    autoTrackDownloads: false\n  },\n\n  // Method to update configuration\n  configure(options) {\n    this.config = { ...this.config, ...options };\n  }\n};\n\n// Auto-initialize if running in browser\nif (typeof window !== 'undefined') {\n  // Make FaWired globally accessible\n  window.FaWired = FaWired;\n  \n  // Auto-initialize\n  FaWired.init();\n  \n  // Log version info in development\n  if (process.env.NODE_ENV === 'development') {\n    console.log(`fa-wired v${VERSION} initialized`);\n  }\n}\n\n// Export for module systems\nexport default FaWired;"],"names":[],"mappings":"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"}